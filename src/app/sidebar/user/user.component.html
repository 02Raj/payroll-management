<div class="bg-gray-100 p-4 mt-16">
    <!-- Header Section -->
    <div class="flex justify-between items-center bg-white p-6 shadow rounded-lg mb-6">
        <h1 class="text-2xl font-semibold text-gray-700">Users</h1>
        <div class="flex items-center space-x-4">
            <button class="bg-blue-500 text-white px-5 py-2 rounded-lg shadow hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400" routerLink="/create-user">
                + Add User
            </button>
            <select
                class="border border-gray-300 text-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
                (change)="onCompanySelect($event)"
                [disabled]="userRole === 'companyAdmin'">
                <option value="">Select Company</option>
                <option *ngFor="let company of companies" [value]="company.companyId">{{ company.companyName }}</option>
            </select>
        </div>
    </div>

    <div *ngIf="selectedCompanyId && userRole !== 'companyAdmin'; else noAccessMessage">
        <div class="bg-white p-4 shadow rounded-lg mb-6 flex items-center space-x-4">
            <input type="text" placeholder="Search users..." class="border border-gray-300 rounded-lg px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-400" />
            <button class="bg-blue-500 text-white px-5 py-2 rounded-lg shadow hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400">
                Search
            </button>
        </div>

        <div class="bg-white shadow rounded-lg overflow-x-auto">
            <table class="min-w-full text-left table-auto">
                <thead class="bg-blue-50 text-blue-600 uppercase text-sm leading-normal">
                    <tr>
                        <th class="py-3 px-6">Name</th>
                        <th class="py-3 px-6">Username</th>
                        <th class="py-3 px-6">User Type</th>
                        <th class="py-3 px-6">Email</th>
                        <th class="py-3 px-6">Company</th>
                        <th class="py-3 px-6">Status</th>
                        <th class="py-3 px-6">Action</th>
                    </tr>
                </thead>
                <tbody class="text-gray-700 text-sm">
                    <tr *ngFor="let user of users" class="border-b hover:bg-blue-50">
                        <td class="py-3 px-6 font-semibold">{{ user.firstName }} {{ user.lastName }}</td>
                        <td class="py-3 px-6">{{ user.userName }}</td>
                        <td class="py-3 px-6">{{ user.role }}</td>
                        <td class="py-3 px-6">{{ user.email }}</td>
                        <td class="py-3 px-6">{{ user.company }}</td>
                        <td class="py-3 px-6">
                            <label class="inline-flex items-center cursor-pointer">
                                <input type="checkbox" [checked]="user.isActive" class="sr-only">
                                <span class="relative">
                                    <span class="block w-10 h-6 bg-gray-300 rounded-full shadow-inner"></span>
                                    <span class="dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full shadow"></span>
                                </span>
                            </label>
                        </td>
                        <td class="py-3 px-6">
                            <button (click)="editUser(user.id)" class="bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-400 flex items-center">
                                <i class="pi pi-pencil mr-2"></i> Edit
                            </button>
                        </td>
                    </tr>
                    <tr *ngIf="users.length === 0" class="border-b hover:bg-gray-50">
                        <td colspan="7" class="text-center py-4 text-gray-500">No records found</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Pagination Section -->
        <div class="flex justify-between items-center p-4 bg-gray-100 mt-6">
            <span class="text-sm text-gray-600">{{currentPage * pageSize + 1}}-{{(currentPage + 1) * pageSize > totalItems ? totalItems : (currentPage + 1) * pageSize}} of {{totalItems}}</span>
            <div class="flex space-x-2">
                <button (click)="goToPreviousPage()" [disabled]="currentPage === 0" class="px-4 py-2 text-sm bg-gray-300 rounded-lg hover:bg-gray-400 disabled:opacity-50">Previous</button>
                <button (click)="goToNextPage()" [disabled]="currentPage === totalPages - 1" class="px-4 py-2 text-sm bg-gray-300 rounded-lg hover:bg-gray-400 disabled:opacity-50">Next</button>
            </div>
        </div>
    </div>

    <!-- No Access Message for companyAdmin -->
    <ng-template #noAccessMessage>
        <div *ngIf="userRole === 'companyAdmin'; else noCompanySelected" class="flex justify-center items-center bg-yellow-50 border border-yellow-200 text-yellow-700 rounded-lg p-4 shadow-md mt-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-yellow-500" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-7V5a1 1 0 10-2 0v6a1 1 0 102 0zm-1 4a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" />
            </svg>
            <span class="text-base">
                Only <strong>SuperAdmin</strong> can view the <strong>User List</strong>.
            </span>
        </div>
    </ng-template>

    <!-- Display this block if no company is selected -->
    <ng-template #noCompanySelected>
        <div class="flex justify-center items-center bg-blue-50 border border-blue-200 text-blue-700 rounded-lg p-4 shadow-md mt-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M18 10c0 4.418-3.582 8-8 8S2 14.418 2 10 5.582 2 10 2s8 3.582 8 8zM9 5a1 1 0 112 0v4a1 1 0 01-2 0V5zM9 13a1 1 0 102 0 1 1 0 00-2 0z" clip-rule="evenodd" />
            </svg>
            <span class="text-base">
                Please select a <strong>Company</strong> first to view <strong>Users</strong>.
            </span>
        </div>
    </ng-template>
</div>
